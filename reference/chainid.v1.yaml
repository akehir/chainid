openapi: 3.0.0
info:
  title: chainid
  version: '1.0'
  contact:
    name: ChainId
    url: Chainid.io
    email: indo@chainid.io
  description: ''
servers:
  - url: 'http://localhost:3000'
paths:
  /login:
    post:
      summary: Login
      operationId: post-login
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                required:
                  - token
      description: logs the user in
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
              required:
                - email
                - password
  /signup:
    post:
      summary: Signup
      operationId: post-signup
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  uuid:
                    type: string
                required:
                  - uuid
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
              required:
                - email
                - password
      description: |
        if signup succesful, the user gets an email with an activation link
  /login/activate:
    post:
      summary: Activates user
      operationId: post-login-activate
      responses:
        '200':
          description: OK
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                uuid:
                  type: string
                secretKey:
                  type: string
              required:
                - uuid
                - secretKey
      description: "this activates the user by changing their status. \n\nThe user then needs to login"
components:
  schemas:
    User:
      title: User
      type: object
      description: |
        User and credentials
      properties:
        id:
          type: string
        person:
          $ref: '#/components/schemas/Person'
        email:
          type: string
        '':
          type: string
    Person:
      title: Person
      type: object
      properties:
        id:
          type: string
        logDateAdded:
          type: string
    Attribute:
      title: Attribute
      type: object
      properties:
        id:
          type: string
        value:
          type: string
        attributeType:
          $ref: '#/components/schemas/AttributeType'
        default:
          type:
            - boolean
            - 'null'
        levelOfAssurance:
          type: string
          description: |-
            See NIST standard on LOA.

            Reverse process of the consent, where a "company" provides attributes of a specific level of assurance to a person.
        levelOfAssuranceCompanyProfile:
          $ref: '#/components/schemas/CompanyProfile'
        '':
          type: string
    AttributeType:
      title: AttributeType
      type: object
      properties:
        id:
          type: string
        label:
          type: string
        description:
          type: string
        '':
          type: string
    Company:
      title: Campany
      type: object
      properties:
        id:
          type: string
    UserCompany:
      title: UserCompany
      type: object
      properties:
        id:
          type: string
    CompanyProfile:
      title: CompanyProfile
      type: object
      description: |
        Data requested by Company
      properties:
        id:
          type: string
        company:
          $ref: '#/components/schemas/Company'
        '':
          type: string
    DataXChange:
      title: DataXChange
      type: object
      properties:
        id:
          type: string
        person:
          $ref: '#/components/schemas/Person'
        companyProfile:
          $ref: '#/components/schemas/CompanyProfile'
        logDateAdded:
          type: string
        expiryDate:
          type:
            - string
            - 'null'
        revokationDate:
          type:
            - string
            - 'null'
        '':
          type: string
    AttributeDataXChange:
      title: AttributeDataXChange
      type: object
      properties:
        id:
          type: string
        dataxchange:
          $ref: '#/components/schemas/DataXChange'
        attribute:
          $ref: '#/components/schemas/Attribute'
        attributeProfileType:
          $ref: '#/components/schemas/AttributeProfileType'
        '':
          type: string
    AttributeProfileType:
      title: AttributeProfileType
      type: object
      properties:
        id:
          type: string
        profile:
          $ref: '#/components/schemas/CompanyProfile'
        attributeType:
          $ref: '#/components/schemas/AttributeType'
        isOptional:
          type: integer
          description: There is more than a binary case.
        '':
          type: string
